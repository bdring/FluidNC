board: Maslow
name: Maslow S3 Board

# Is the maslow on vertical (true) or horizontal (false)
Maslow_vertical: false

# Define the distance from the anchor points to the corners of the calibration grid in mm
maslow_calibration_grid_width_mm_X: 1500
maslow_calibration_grid_height_mm_Y: 800

# Defines the number of points in the calibration grid. Options are 3,5,7,9
maslow_calibration_grid_size: 7

#####################################################################
# Frame anchor points are now defined in the kinematics section below

# Sets how hard should Maslow pull on the belts to retract before considering them to be all the way in.
# Maximum value is 4,000. Arbitrary units.
Maslow_Retract_Current_Threshold: 900
# Sets how hard should Maslow pull on the belts during the calibration process.
Maslow_Calibration_Current_Threshold: 900
# Sets the acceptable fitness threshold for moving on to the next calibration round.
Maslow_Acceptable_Calibration_Threshold: 0.45
# Sets the scale factor for the x axis. 
Maslow_Scale_X: 1.0
# Sets the scale factor for the y axis.
Maslow_Scale_Y: 1.0
# Sets the distance to extend the bels during the calibration process.
Maslow_Extend_Dist: 1700


####################
# Below here should not need to change, these are related to how fluidcnc connects to the board.

spi:
  miso_pin: gpio.13
  mosi_pin: gpio.11
  sck_pin: gpio.12

sdcard:
  card_detect_pin: NO_PIN
  cs_pin: gpio.10

stepping:
  engine: RMT
  idle_ms: 240

uart1:
  txd_pin: gpio.1
  rxd_pin: gpio.2
  baud: 115200
  mode: 8N1

kinematics:
  MaslowKinematics:
    # Frame anchor points - all values in millimeters
    # By convention bottom left is (0,0) and bottom right is (width,0)
    # Bottom, top, left, right are defined with power cord down, looking from top
    
    # Top left corner of frame (nominally 0, height)
    tlX: 6.8
    tlY: 2073.699951
    tlZ: 100.0  # Height of anchor point above arm
    
    # Top right corner of frame (nominally width, height)
    trX: 3077.600098
    trY: 2070.100098
    trZ: 56.0   # Height of anchor point above arm
    
    # Bottom left corner (nominally 0,0)
    blX: 0.0
    blY: 0.0
    blZ: 34.0   # Height of anchor point above arm
    
    # Bottom right corner (nominally width,0)
    brX: 3080.100098
    brY: 0.0
    brZ: 78.0   # Height of anchor point above arm
    
    # Belt/arm configuration
    beltEndExtension: 30.0  # Extension distance during calibration
    armLength: 123.4        # Length of the router arm

axes:
  a:  # Top Left belt motor (TL)
    max_rate_mm_per_min: 3000
    acceleration_mm_per_sec2: 50
    max_travel_mm: 5000
    homing:
      cycle: -1

    motor0:
      dc_servo:

  b:  # Top Right belt motor (TR) 
    max_rate_mm_per_min: 3000
    acceleration_mm_per_sec2: 50
    max_travel_mm: 5000
    homing:
      cycle: -1

    motor0:
      dc_servo:

  c:  # Bottom Left belt motor (BL)
    max_rate_mm_per_min: 3000
    acceleration_mm_per_sec2: 50
    max_travel_mm: 5000
    homing:
      cycle: -1

    motor0:
      dc_servo:

  d:  # Bottom Right belt motor (BR)
    max_rate_mm_per_min: 3000
    acceleration_mm_per_sec2: 50
    max_travel_mm: 5000
    homing:
      cycle: -1

    motor0:
      dc_servo:

  z:  # Router Z-axis
    steps_per_mm: 100
    max_rate_mm_per_min: 400
    acceleration_mm_per_sec2: 10
    max_travel_mm: 100
    homing:
      cycle: -1

    motor0:
      tmc_2209:
        uart_num: 1
        addr: 0
        cs_pin: NO_PIN
        r_sense_ohms: 0.110
        run_amps: 1.000
        hold_amps: 0.500
        microsteps: 0
        stallguard: 0
        stallguard_debug: false
        toff_disable: 0
        toff_stealthchop: 5
        toff_coolstep: 3
        run_mode: StealthChop
        homing_mode: StealthChop
        use_enable: true
        direction_pin: gpio.16
        step_pin: gpio.15

    motor1:
      tmc_2209:
        uart_num: 1
        addr: 1
        cs_pin: NO_PIN
        r_sense_ohms: 0.110
        run_amps: 1.000
        hold_amps: 0.500
        microsteps: 0
        stallguard: 0
        stallguard_debug: false
        toff_disable: 0
        toff_stealthchop: 5
        toff_coolstep: 3
        run_mode: StealthChop
        homing_mode: StealthChop
        use_enable: true
        direction_pin: gpio.38
        step_pin: gpio.46
